# camerapusher-by-susuliangliang
苏苏亮亮的wifi棒子 小车 jar的反汇编，好像需要c++库，小白在研究中

已剪辑自: https://www.kancloud.cn/a813630449/ufi_car/2779674

介绍
本教程是通过高通410类随身wifi设备，刷入debian系统+一系列硬件，运行我开发的图传+数传应用，使用APP作为遥控器，实现4G远程遥控小车的功能，图传延迟局域网情况下400-600ms，4G情况下，如果网络良好、服务器速度良好大概600-1500ms左右，遥控数传几乎感觉不到延迟。
目前主要实现了以下功能：
1.小车基本控制功能，前进、后退、左转、右转、摄像头左右旋转、一路灯光开关控制，6级固定速度调节或无级变速，视频画质三级调节，前驱、后驱、四驱切换（前提要使用双向电调，就是有两路电机输出的）
 2. 低延迟双向音视频传输，手机APP端可以实时收到小车端音视频画面，APP端可以按住麦克风按钮实时向小车端对讲
 3. 支持本地局域网控制模式和4G远程控制模式，4G远程控制模式需要自己有服务器或使用其他第三方内网穿透服务
硬件准备
	1. 高通410随身WIFI一个（例：ufi001c、ufi001b、sp970、uz801等），只需要能刷handsomehacker大佬的debian系统的设备即可，但是如果不能使用4g的设备（比如sp970）只能本地局域网控制，不能远程控制
	2. Arduino Nano单片机+扩展板，如下图，不要买错

	
	3. 有刷或无刷电调（具体看你使用的是无刷电机还是有刷电机）,使用双向电调可以实现前驱、后驱、四驱切换。
	4. 带麦克风的USB免驱摄像头
	5. Zy143L大佬的USB HUB扩展坞，或者普通的USB分线器，用来连接摄像头和单片机
	6. B25电压检测模块，用来检测电池电压显示在APP（如果不需要显示电压可以不需要）
	7. USB免驱声卡+喇叭，小车端用来播放实时对讲的音频（如果不需要对讲可以不需要）
	8. 舵机，用来APP调节摄像头角度（如果不需要调节可以不需要）

软件准备
1.我编译好的Debian系统，已经集成串口驱动、小车的图传+数传应用、JAVA运行环境、开机自启动小车程序和WIFI热点，WIFI:4G_Wifi_Car,密码12345678，系统登录账号为：root,密码：1，
 2.遥控端APP安装包
 3.Arduino单片机源码和Arduino IDE单片机开发工具，用来烧录单片机程序
上述资源下载地址：下载链接,访问码：pgo8
下一篇：详细步骤
1.连接所有硬件，把随身WIFI插上USB扩展坞，摄像头和Arduino单片机插到扩展坞上，插好Arduino单片机扩展板，把电调、转向舵机、摄像头舵机、LED灯分别插到Arduino扩展板对应的插口,插口定义如下：
 7：前驱电调
 8：后驱电调
 9：转向舵机
 10：摄像头舵机
 11：LED灯
 A0:B25电压检测模块


1.首先在随身WIFI刷入Debian系统，下载链接,访问码：b44h
 刷入方法：
 首先adb reboot bootloader(或其他方式)让设备进入BootLoader模式，然后打开下载好的对应设备的Debian系统固件，Win系统双击flash.bat，Mac或Linux系统执行flash.sh开始刷机，一键式刷机，脚本执行完毕后就刷好了，会自动重启。（注意：最好先刷一遍全网通基QCN，且需要不插卡刷入系统，否则可能modem不正常！！！）
 2.Arduino单片机刷入小车程序，Arduino程序源码(下载链接）,访问码：g0d6，
 刷入方法：
 打开Arduino IDE开发工具（下载地址），安装好ch340串口驱动，导入newcar源码，把Arduino板子插到电脑上，在工具->端口菜单下选择好Arduino的串口，开发板选择Arduino Nano，处理器选择ATmega328P（Old Bootloader），然后点击上传按钮，等待写入完毕即可。
 3.手机端安装遥控APP，下载地址，访问码：2zt2
 4.完成上述步骤小车已经可以实现本地局域网控制了，小车启动后手机连接4G_Wifi_Car热点，打开遥控端APP，配置小车IP地址：192.168.68.1，就可以看到小车摄像图画面和控制了，如果想要实现4G远程控制，需要在服务器上运行端口映射程序实现，具体方法如下：
 下载服务器端口映射程序（下载地址，访问码：wzb8），在服务器上安装java jdk环境，把natx-server-1.0.3.jar上传到服务器，执行nohup java -jar natx-server-1.0.3.jar -port 7731 -password 123 & 启动程序，并且开放服务器7731和6000端口，ssh连接到随身wifi的Debian系统，编辑/app/camerapusher.yaml文件，填入服务器ip，端口（7731），密码（默认123），重启随身wifi，在遥控端APP内配置服务器IP地址，即可开启4G远程遥控。
注意事项
	1. 必须加散热风扇，如不加过几分钟会发热严重造成画面卡顿；
	2. 可更换高增益4G天线，否则4G网络不佳的情况下可能导致小车远程失联；
	3. 刷Debian系统之前最好先刷一遍全网通基带QCN，并且要不插卡刷入系统，否则可能modem不正常
Debian
更新日志
	• 2022-06-08 点击下载
 该版本默认是随身WIFI模式，开机后自动开启热点，名称：4G_UFI_123456，密码：12345678，并且会开机USB网络共享
 该版本可在随身WIFI和遥控车模式间切换，SSH登录到Debian系统，执行./ufi.sh,根据提示可切换模式和修改热点密码

	• 2022-05-22 点击下载
 默认开启root登录，用户名：root，密码：1
 设置中国时区，集成jdk1.8环境，集成4G遥控车主控端程序，集成ch341和pl2303串口驱动，集成rtl8152驱动，更换阿里源，语言更改为中文
 注：该版本默认是遥控车模式，开机后自动开启热点，名称：4G_Wifi_Car，密码：12345678，并且关闭usb网络共享，切换USB Host模式

：OpenWrt
更新日志
	• 2023-04-28 点击下载
 集成以下插件：
 istore、docker、AdGuard Home、OpenClash、ddnsgo、usb打印服务器、web终端、frp客户端、串口转发、aria2、samba、nfs、zerotier、在线文件管理、
 集成以下驱动：
 串口驱动ch340、pl2303、cp2102、网卡驱动8152、usb摄像头驱动、rndis驱动

	• 2022-06-08 点击下载
 在上个版本基础上增加如下插件：
 passwall，在线应用商店，在线文件管理，diskman磁盘管理

	• 2022-06-05 点击下载
 在上个版本基础上增加如下插件：
 curl/wget网络工具，docker，自动挂载，默认argon主题
 默认配置正确的opkg源，可以直接在线安装插件

	• 2022-05-30 点击下载 密码:2j96
 增加以下插件：
 samba网络共享，zerotier内网穿透，filetransfer文件传输，aria2下载工具，ttyd网页终端，ext4、ntfs、fat格式支持，nfs挂载，rt8152网卡驱动，usb打印机驱动，rndis驱动
	• 2022-05-22 ： 初始版本发布，预计下个版本支持：
	
		1. APP内或网页端配置热点名称、密码、映射服务器地址端口密码等信息
		2. 增加不需要自己服务器的外网映射方案
	下一篇：讨论交流
![image](https://github.com/3BPM/camerapusher-by-susuliangliang/assets/30543687/c096ccf5-f9e7-4059-a175-c97714007347)
